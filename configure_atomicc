#/bin/bash
#
set -e
set -x

#RELEASE="DEBUG"
RELEASE="PRODUCTION"

CC=/usr/bin/clang CXX=/usr/bin/clang++ LDFLAGS="-g -lBlocksRuntime" CFLAGS="-fblocks -g" CXXFLAGS="-fblocks -g" cmake \
    -DLLVM_EXTERNAL_CLANG_SOURCE_DIR:PATH=../../clang \
    -DLLVM_TARGETS_TO_BUILD=Atomicc \
    -DBUILD_SHARED_LIBS:BOOL=OFF \
    -DCMAKE_BUILD_TYPE=$RELEASE \
    -DLLVM_INCLUDE_TESTS:BOOL=OFF \
    -DLLVM_ENABLE_FFI:BOOL=ON \
    -DLLVM_INCLUDE_EXAMPLES:BOOL=OFF \
    -DLLVM_INCLUDE_DOCS:BOOL=OFF \
    -DCLANG_ENABLE_ARCMT:BOOL=OFF \
    -DCLANG_ENABLE_STATIC_ANALYZER:BOOL=OFF \
    -DLLVM_DEFAULT_TARGET_TRIPLE:STRING="atomicc-unknown-linux-gnu" \
    ..

#    -DLLVM_INCLUDE_UTILS:BOOL=OFF \
#    -DLLVM_INCLUDE_TOOLS:BOOL=OFF \
#    -DLLVM_BUILD_RUNTIME
#    -DLLVM_BUILD_EXAMPLES
#    -DLLVM_BUILD_TOOLS
